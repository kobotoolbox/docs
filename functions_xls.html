<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Using functions in XLSForm &#8212; KoboToolbox  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/kpi-icons/k-icons.css?v=f024171e" />
    <link rel="stylesheet" type="text/css" href="_static/css/kobo_theme.css?v=e77fa1ad" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/breadcrumbs.js?v=c8d147b4"></script>
    <script src="_static/js/common.js?v=8aedd183"></script>
    <script src="_static/js/custom_sections.js?v=1af9d801"></script>
    <script src="_static/js/home_page_toc.js?v=4ce414b4"></script>
    <script src="_static/js/scrollto.js?v=a0f31cce"></script>
    <script src="_static/js/sidebar_toc.js?v=87ef0ba3"></script>
    <script src="_static/js/smoothscroll-polyfill.js?v=181acdfa"></script>
    <script src="_static/js/table-sheets.js?v=ddec4369"></script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding skip logic in XLSForm" href="skip_logic_xls.html" />
    <link rel="prev" title="Introduction to form logic in XLSForm" href="form_logic_xls.html" />
  <meta name="zd-site-verification" content="hdkx1desj8fzjecaf3fie" />
  
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  


  </head><body>
<header role="banner" class="main-header" id="main-header">
  <div class="main-header__logo-container">
    <a href="https://kobotoolbox.org/#home" class="main-header__logo">
      <img src="./_static/images/kobologo.svg" alt="KoboToolbox">
    </a>
  </div>
  <nav class="main-header__navigation" role="navigation">
    <ul>
      <li><a href=index.html>Home</a></li>
      <li><a href="https://support.kobotoolbox.org/about_kobotoolbox.html">About us</a></li>
      <li><a href="https://www.kobotoolbox.org/features">Features</a></li>
      <li><a href="https://www.kobotoolbox.org/services">Services</a></li>
      <li><a href="https://www.kobotoolbox.org/pricing">Pricing</a></li>
      <li><a href="https://www.kobotoolbox.org/blog">Blog</a></li>
      <li class="current"><a href="https://www.kobotoolbox.org/help">Help</a></li>
      <li>
        <a class="button" href="https://kobotoolbox.org/donate">Donate</a>
      </li>
    </ul>
  </nav>
</header>
<section class="main-search " role="search">
  <!-- copied and heavily changed content of built-in `searchbox.html` -->
  <div class="wrapper">
    <div class="main-search__content">
      <h1 class="main-search__header">What do you need help with?</h1>

      <p class="main-search__paragraph">Search the knowledge base, browse our resources, and visit our forum for more detailed information</p>

      <form id="searchbox" class="main-search__form" action="search.html" method="get">
        <div class="main-search__text-box-wrapper">
          <input
            class="main-search__text-box"
            type="search"
            name="q"
            aria-labelledby="searchlabel"
            placeholder="Type your search here"
          />

          <i class="icon main-search__magnifying-glass">
            <svg height="30" viewBox="0 0 30 30" width="30" xmlns="http://www.w3.org/2000/svg"><path d="m12.1784138 21.3122241c-2.43872739 0-4.73283609-.9499163-6.45760394-2.6746841-1.72629015-1.7247679-2.67620642-4.0188766-2.67620642-6.4591262 0-2.43872739.94991627-4.73283609 2.67620642-6.45760394 1.72476785-1.72629015 4.01887655-2.67620642 6.45760394-2.67620642 2.4387273 0 4.732836.94991627 6.4576039 2.67620642 1.7262901 1.72476785 2.6762064 4.01887655 2.6762064 6.45760394 0 2.4402496-.9499163 4.7343583-2.6762064 6.4591262-1.7247679 1.7247678-4.0188766 2.6746841-6.4576039 2.6746841zm17.8215862 6.5352413-8.2082509-8.2097732c1.6562643-2.1251332 2.5650784-4.7206576 2.5650784-7.4592784 0-3.25315881-1.2680773-6.31146297-3.5682752-8.61013857-2.2986756-2.3017202-5.3569798-3.56827523-8.6101385-3.56827523-3.25315881 0-6.31146297 1.26655503-8.61013857 3.56827523-2.3001979 2.2986756-3.56827523 5.35697976-3.56827523 8.61013857 0 3.2531587 1.26807733 6.3114629 3.56827523 8.6101385 2.2986756 2.3017202 5.35697976 3.5682752 8.61013857 3.5682752 2.7386208 0 5.3341452-.9072918 7.4592784-2.5666007l8.2097732 8.2097732z"/></svg>
          </i>
        </div>

        <input class="main-search__submit-button" type="submit" value="Go">
      </form>
    </div>

    <i class="icon main-search__arrow" id="main-search-arrow">
      <svg height="15" viewBox="0 0 23 15" width="23" xmlns="http://www.w3.org/2000/svg"><path d="m713.912501 361.966876c.534917-.563071 1.402814-.61966 2.004099-.154391l.116524.100016 11.144736 10.587496-11.144736 10.587502c-.600609.570579-1.550044.546234-2.120623-.054375-.534918-.563071-.546954-1.432728-.051482-2.009378l.105857-.111245 8.854124-8.412504-8.854124-8.412498c-.563071-.534917-.61966-1.402814-.154391-2.004099z" transform="matrix(0 1 -1 0 383.838929 -712.838929)"/></svg>
    </i>
  </div>

  <script>$('#searchbox').show(0);</script>
</section>

<div class="page page--has-sidebar " id="functions_xls">
  <div class="page__wrapper">
      <section class="page__content">
        
        <nav class="page__breadcrumbs">
          <ul id="breadcrumbslist" class="breadcrumbs"><li class="breadcrumb breadcrumb--home">
            <a href="index.html"><svg height="12" viewBox="0 0 13 12" width="13" xmlns="http://www.w3.org/2000/svg"><path d="m6.19047619.012c.33057143 0 .64133333.1248.87533333.351l4.95176188 4.788c.3553334.3444.4611905.858.2692857 1.3074-.1912857.4512-.6407142.7416-1.144.7416h-.6190476v4.2c0 .3312-.2773333.6-.6190476.6h-2.47619047v-3h-2.47619048v3h-2.47619047c-.34171429 0-.61904762-.2688-.61904762-.6v-4.2h-.61904762c-.50204762 0-.95085714-.2904-1.14338095-.7404-.19252381-.4506-.08666667-.9642.26804762-1.308l4.95299999-4.7892c.23338096-.2256.54414286-.3504.87471429-.3504z"/></svg>Home</a>
          </li></ul>
        </nav>
        

        <section class="page__body" role="main">
          
  <section id="using-functions-in-xlsform">
<h1>Using functions in XLSForm<a class="headerlink" href="#using-functions-in-xlsform" title="Link to this heading">¶</a></h1>
<p><strong>Last updated:</strong> <a href="https://github.com/kobotoolbox/docs/blob/3b9d6690d9ae3fbfc12d57fa1df2dd94bba8badb/source/functions_xls.md" class="reference">15 Dec 2025</a></p>
<p>Functions are predefined operations used to perform calculations or manipulate data in XLSForm. They are essential for automating tasks and deriving key insights in your forms, allowing you to calculate project indicators, create scoring systems, and manage dates efficiently.</p>
<p>This article lists common functions used in XLSForm, including functions to manipulate numbers, strings, dates, and GPS points.</p>
<p class="note">
  To learn more about form logic in XLSForm, see <a href="https://support.kobotoolbox.org/form_logic_xls.html">Introduction to form logic in XLSForm</a>. To learn about functions specifically used in repeat groups, see <a href="https://support.kobotoolbox.org/repeat_groups_xls.html">Repeat groups in XLSForm</a>.
</p>
<section id="commonly-used-functions-in-xlsform">
<h2>Commonly used functions in XLSForm<a class="headerlink" href="#commonly-used-functions-in-xlsform" title="Link to this heading">¶</a></h2>
<p>The following functions are some of the most frequently used in XLSForm. They help control form behavior, manage responses, and perform basic calculations or logical operations across questions. These functions can be applied in calculations, constraints, relevance conditions, and other expressions throughout your form.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">if(expression,</span> <span class="pre">then,</span> <span class="pre">else)</span></code></p></td>
<td class="text-left"><p>If the expression is TRUE, returns <code class="docutils literal notranslate"><span class="pre">then</span></code>. If not, returns <code class="docutils literal notranslate"><span class="pre">else</span></code>.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">selected(${question_name},</span> <span class="pre">option_name)</span></code></p></td>
<td class="text-left"><p>Used to determine if a specific choice was selected in a <code class="docutils literal notranslate"><span class="pre">select_multiple</span></code> question.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">random()</span></code></p></td>
<td class="text-left"><p>Returns a random number between 0.0 (inclusive) and 1.0 (exclusive).</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">count-selected(${question_name})</span></code></p></td>
<td class="text-left"><p>Returns the number of options selected in a <code class="docutils literal notranslate"><span class="pre">select_multiple</span></code> question.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">coalesce(${question1},</span> <span class="pre">${question2})</span></code></p></td>
<td class="text-left"><p>Returns the first non-empty value of the two arguments. Returns an empty string if both are empty or non-existent.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">jr:choice-name(choice_name,</span> <span class="pre">'${question_name}')</span></code></p></td>
<td class="text-left"><p>Returns the label value, in the active language, associated with the <code class="docutils literal notranslate"><span class="pre">choice_name</span></code> in the list of choices for a select type question. To retrieve the label of whichever response was selected, use <code class="docutils literal notranslate"><span class="pre">jr:choice-name(${question_name},</span> <span class="pre">'${question_name}')</span></code>.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">selected-at(${question_name},</span> <span class="pre">n)</span></code></p></td>
<td class="text-left"><p>Returns the selected choice in a <code class="docutils literal notranslate"><span class="pre">select_multiple</span></code> question at position <strong>n+1</strong>. For example, <code class="docutils literal notranslate"><span class="pre">selected-at(${question_name},</span> <span class="pre">2)</span></code> returns the third choice selected in a <code class="docutils literal notranslate"><span class="pre">select_multiple</span></code> question.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">once(expression)</span></code></p></td>
<td class="text-left"><p>Evaluates an expression only once (e.g., to ensure a random number is only generated once, or to store the first value entered for a question even if the response is changed later).</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">instance('list_name')/root/item[name</span> <span class="pre">=</span> <span class="pre">${question}]/column_name</span></code></p></td>
<td class="text-left"><p>Retrieves a value from the choices sheet. Searches the choice list named <code class="docutils literal notranslate"><span class="pre">list_name</span></code>, finds the row where the choice <code class="docutils literal notranslate"><span class="pre">name</span></code> matches the response to <code class="docutils literal notranslate"><span class="pre">${question}</span></code>, and returns the value from the column specified as <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions-to-manipulate-numbers">
<h2>Functions to manipulate numbers<a class="headerlink" href="#functions-to-manipulate-numbers" title="Link to this heading">¶</a></h2>
<p>The following functions are used to perform mathematical operations or transform numeric values in XLSForm. They can help you calculate, round, or convert numbers, as well as apply more advanced mathematical expressions when needed.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">int(number)</span></code></p></td>
<td class="text-left"><p>Transforms a decimal number into an integer without rounding.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">round(number,</span> <span class="pre">places)</span></code></p></td>
<td class="text-left"><p>Rounds a decimal value to a predetermined number of decimal places.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">pow(number,</span> <span class="pre">power)</span></code></p></td>
<td class="text-left"><p>Calculates the power of a number.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">number(x)</span></code></p></td>
<td class="text-left"><p>Converts x (a string or boolean expression) to a number value.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">log(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">log10(number)</span></code></p></td>
<td class="text-left"><p>Returns the natural log or base-10 log of a number.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">abs(number)</span></code></p></td>
<td class="text-left"><p>Returns the absolute value of a number.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sin(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">asin(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">cos(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">acos(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">tan(number)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">atan(number)</span></code></p></td>
<td class="text-left"><p>Returns the sine/arc sine, cosine/arc cosine, or tangent/arc tangent of a number.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sqrt(number)</span></code></p></td>
<td class="text-left"><p>Returns the square root of a number.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">exp(x)</span></code> <br> <code class="docutils literal notranslate"><span class="pre">exp10(x)</span></code></p></td>
<td class="text-left"><p>Returns e^x or 10^x.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">pi()</span></code></p></td>
<td class="text-left"><p>Returns an approximation of the mathematical constant π.</p></td>
</tr>
</tbody>
</table>
<p class="note">
  <strong>Note:</strong> Inside these functions, either constants or <a href="https://support.kobotoolbox.org/form_logic_xls.html#question-referencing">question references</a> can be included.
</p>
</section>
<section id="functions-to-manipulate-strings">
<h2>Functions to manipulate strings<a class="headerlink" href="#functions-to-manipulate-strings" title="Link to this heading">¶</a></h2>
<p>The following functions are used to create, modify, or analyze text strings in XLSForm. They are useful for combining text, checking for specific patterns or characters, and cleaning or formatting text inputs.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">concat()</span></code></p></td>
<td class="text-left"><p>Concatenates one or more arguments (separated by commas) into a single string.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">regex(string,</span> <span class="pre">expression)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if the string is an exact and complete match for a <a href="https://support.kobotoolbox.org/restrict_responses.html">regular expression</a>.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">contains(string,</span> <span class="pre">substring)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if the string contains the substring.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">starts-with(string,</span> <span class="pre">substring)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if the string begins with the substring.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">ends-with(string,</span> <span class="pre">substring)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if the string ends with the substring.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">substr(string,</span> <span class="pre">start,</span> <span class="pre">end)</span></code></p></td>
<td class="text-left"><p>Returns the substring of <code class="docutils literal notranslate"><span class="pre">string</span></code> beginning at the index <code class="docutils literal notranslate"><span class="pre">start</span></code> and extending to (but not including) index <code class="docutils literal notranslate"><span class="pre">end</span></code> (or to the termination of <code class="docutils literal notranslate"><span class="pre">string</span></code>, if <code class="docutils literal notranslate"><span class="pre">end</span></code> is not provided).</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">substring-before(string,</span> <span class="pre">target)</span></code></p></td>
<td class="text-left"><p>Returns the substring of <code class="docutils literal notranslate"><span class="pre">string</span></code> before the first occurrence of the target substring. If the target is not found, or <code class="docutils literal notranslate"><span class="pre">string</span></code> begins with the target substring, then this will return an empty string.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">substring-after(string,</span> <span class="pre">target)</span></code></p></td>
<td class="text-left"><p>Returns the substring of <code class="docutils literal notranslate"><span class="pre">string</span></code> after the first occurrence of the target substring. If the target is not found this will return an empty string.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">translate(string,</span> <span class="pre">fromchars,</span> <span class="pre">tochars)</span></code></p></td>
<td class="text-left"><p>Returns a copy of string, where every occurrence of a character in <code class="docutils literal notranslate"><span class="pre">fromchars</span></code> is replaced by the corresponding character in <code class="docutils literal notranslate"><span class="pre">tochars</span></code> (e.g., replacing all lowercase letters with uppercase letters). <br><br> <strong>Note:</strong> If <code class="docutils literal notranslate"><span class="pre">fromchars</span></code> is longer than <code class="docutils literal notranslate"><span class="pre">tochars</span></code>, every occurrence of a character in <code class="docutils literal notranslate"><span class="pre">fromchars</span></code> that does not have a corresponding character in <code class="docutils literal notranslate"><span class="pre">tochars</span></code> will be removed.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">string-length(string)</span></code></p></td>
<td class="text-left"><p>Returns the number of characters in <code class="docutils literal notranslate"><span class="pre">string</span></code> (e.g., to add a word limit to a text question).</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">normalize-space(string)</span></code></p></td>
<td class="text-left"><p>Returns a string in which any leading and trailing whitespaces in the string are removed, and sequences of whitespaces are replaced with a single space.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions-to-manipulate-dates">
<h2>Functions to manipulate dates<a class="headerlink" href="#functions-to-manipulate-dates" title="Link to this heading">¶</a></h2>
<p>The following functions are used to record, format, and calculate date and time values in XLSForm. They can help capture the current date or time, convert text into date format, or display dates and times in a specific format.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">today()</span></code></p></td>
<td class="text-left"><p>Returns the current date without a time component.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">now()</span></code></p></td>
<td class="text-left"><p>Returns the current date and time in ISO 8601 format, including the timezone.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">date('YYYY-MM-DD')</span></code></p></td>
<td class="text-left"><p>Forces dates into the correct date format (especially for dates before 1970).</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">format-date(date,</span> <span class="pre">format)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">date</span></code> as a string formatted as defined by <code>format</code>. Common formats include: <ul><li><code>%Y</code>: 4-digit year</li><li><code>%y</code>: 2-digit year</li><li><code>%m</code>: 0-padded month</li><li><code>%n</code>: numeric month</li><li><code>%b</code>: short text month (Jan, Feb, Mar…)</li><li><code>%d</code>: 0-padded day of month</li><li><code>%e</code>: day of month</li><li><code>%a</code>: short text day (Sun, Mon, Tue…).</li></ul></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">format-date-time(datetime,</span> <span class="pre">format)</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">datetime</span></code> as a string formatted as defined by <code>format</code>. Common formats include: <ul><li><code>%H</code>: 0-padded hour (24-hr time)</li><li><code>%h</code>: hour (24-hr time)</li><li><code>%M</code>: 0-padded minute</li><li><code>%S</code>: 0-padded second</li><li><code>%3</code>: 0-padded millisecond ticks.</li></ul></p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions-to-manipulate-gps-data">
<h2>Functions to manipulate GPS data<a class="headerlink" href="#functions-to-manipulate-gps-data" title="Link to this heading">¶</a></h2>
<p>The following functions are used to work with geographic data collected through GPS questions in XLSForm. They can calculate distances, perimeters, or areas based on geopoint, geotrace, or geoshape responses.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">area(${geoshape})</span></code></p></td>
<td class="text-left"><p>Returns the area, in square meters, of a <code class="docutils literal notranslate"><span class="pre">geoshape</span></code> value.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">distance(geo)</span></code></p></td>
<td class="text-left"><p>Returns the distance, in meters, of either: <ul><li>the perimeter of a <code class="docutils literal notranslate"><span class="pre">geoshape</span></code> value</li><li>the length of a <code class="docutils literal notranslate"><span class="pre">geotrace</span></code> value</li><li>a list of geopoints either specified as strings or references to other fields (including from repeat groups), separated by commas</li></ul></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">geofence(${geopoint},</span> <span class="pre">${geoshape})</span></code></p></td>
<td class="text-left"><p>Returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if the specified <code class="docutils literal notranslate"><span class="pre">${geopoint}</span></code> is inside the specified <code class="docutils literal notranslate"><span class="pre">${geoshape}</span></code>, <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> otherwise. Supported only in KoboCollect.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


          <div class="clearer"></div>
        </section>

        

        <div class="page__back-to-top-container">
          <a href="#top" class="page__back-to-top">Back to top</a>
        </div>
        
          <section class="page__feedback">
            <h1>Was this article useful?</h1>

            <p>Did you find what you were looking for? Was the information clear? Was anything missing?<br>Share your feedback to help us improve this article!</p>

            <a
              href="https://ee-eu.kobotoolbox.org/single/OPizwor2?d[page]=Using functions in XLSForm"
              class="feedback-button"
              target="_blank"
            >
              Fill out the short survey here &rarr;
            </a>
          </section>
      </section>

      
        <aside class="page__sidebar" role="navigation" aria-label="main navigation">

<div class="sidebar_tocs">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Introduction to KoboToolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_account.html">Creating an account on KoboToolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quickstart guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary of KoboToolbox terms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Account &amp; Billing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="creating_account.html">Creating an account on KoboToolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="activation_link.html">Troubleshooting account activation link</a></li>
<li class="toctree-l1"><a class="reference internal" href="reset_password.html">Resetting Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="two_factor_authentication.html">Setting up two-factor authentication in KoboToolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Formbuilder</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="formbuilder.html">Getting started with the KoboToolbox Formbuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_types.html">List of Question Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_and_note.html">Text and Note question types</a></li>
<li class="toctree-l1"><a class="reference internal" href="select_one_and_select_many.html">“Select One” and “Select Many” question types</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledge.html">Acknowledge question type</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_decimal_range.html">Number, Decimal, and Range Question Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="date_time.html">Date and time question types</a></li>
<li class="toctree-l1"><a class="reference internal" href="photo_audio_video_file.html">Media question types</a></li>
<li class="toctree-l1"><a class="reference internal" href="barcode_qrcode_questions.html">Barcode/QR code question type</a></li>
<li class="toctree-l1"><a class="reference internal" href="rating_ranking.html">Rating vs Ranking Question Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_file.html">Select One or Many From External File Question Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="gps_questions.html">GPS Question types</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculate_questions.html">Calculate Question Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_calculate.html">Advanced Calculate Question Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="collecting_signatures.html">Signature Question Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_response.html">Question Matrix Response Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="responses_inside_question.html">Including Responses Inside Another Question</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_options.html">Using the Question Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="skip_logic.html">Adding skip logic in the Formbuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation_criteria.html">Adding validation criteria in the Formbuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_text_responses.html">Limits on Number and Text Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="cascading_select.html">Adding cascading select questions in the Formbuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_repeat.html">Grouping questions and repeating groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="restrict_responses.html">Restricting Text Responses With Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="language_dashboard.html">Adding Another Language in the Project Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="form_meta.html">Form Settings and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit_logging.html">Audit Logging Meta Question Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_format_web.html">Custom Formatting in Web Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="alternative_enketo.html">Using Alternative Enketo Web Form Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_library.html">Using the Question Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_public_collections.html">Using Public Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="public_collections_advanced_search.html">Public Collections Advanced Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="hxl.html">Using HXL Tags</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using XLSForm</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="edit_forms_excel.html">Introduction to XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_xlsform.html">Getting started with XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="xlsform_with_kobotoolbox.html">Using XLSForm with KoboToolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_types_xls.html">Question types in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="option_choices_xls.html">Managing option choices in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="grouping_questions_xls.html">Grouping questions in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="repeat_groups_xls.html">Repeat groups in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="question_options_xls.html">Using question options in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="appearances_xls.html">Question appearances in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="language_xls.html">Adding translations in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="media.html">Adding media to an XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="form_logic_xls.html">Introduction to form logic in XLSForm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using functions in XLSForm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#commonly-used-functions-in-xlsform">Commonly used functions in XLSForm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-to-manipulate-numbers">Functions to manipulate numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-to-manipulate-strings">Functions to manipulate strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-to-manipulate-dates">Functions to manipulate dates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-to-manipulate-gps-data">Functions to manipulate GPS data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="skip_logic_xls.html">Adding skip logic in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraints_xls.html">Adding constraints in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="required_logic_xls.html">Adding required logic in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="choice_filters_xls.html">Adding choice filters in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculations_xls.html">Adding calculations in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="form_settings_xls.html">Form settings in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="form_style_xls.html">Styling your forms using XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_xls.html">Form metadata in XLSForm</a></li>
<li class="toctree-l1"><a class="reference internal" href="pull_data_kobotoolbox.html">Pulling data from an external CSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="select_from_file_xls.html">Selecting options from an external file</a></li>
<li class="toctree-l1"><a class="reference internal" href="select_from_map_xls.html">Selecting options from a map</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_data_attachment.html">Dynamic data attachments</a></li>
<li class="toctree-l1"><a class="reference internal" href="library_locking.html">Library locking with XLSForm</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Collecting Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data-collection-tools.html">Overview on Data Collection Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="enketo.html">What Are Enketo Web Forms?</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_form_new_project.html">Deploying a Form to Start a New Data Collection Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="recording-interviews.html">Recording interviews with background audio recording</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_through_webforms.html">Collecting Data through Web Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-offline.html">Collecting Data Offline</a></li>
<li class="toctree-l1"><a class="reference internal" href="kobocollect_on_android_latest.html">Getting started with KoboCollect</a></li>
<li class="toctree-l1"><a class="reference internal" href="kobocollect_settings.html">Customizing KoboCollect settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_collection_kobocollect.html">Data collection using KoboCollect</a></li>
<li class="toctree-l1"><a class="reference internal" href="transferring_forms.html">Transferring forms and data manually from one android device to another</a></li>
<li class="toctree-l1"><a class="reference internal" href="devices_for_data_collection.html">Recommended Devices for Data Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting_kobocollect.html">Troubleshooting KoboCollect Android Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting_webforms.html">Troubleshooting Enketo Web Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="collect_gps.html">Collecting GPS data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Managing Projects &amp; Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="project_summary.html">Project Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="record_validation.html">Record Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete_project.html">Deleting a Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="export_download.html">Exporting and downloading your data</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_export.html">Advanced options for exporting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_repeat_groups.html">Managing repeat group data</a></li>
<li class="toctree-l1"><a class="reference internal" href="archiving_projects.html">Archiving and Unarchiving Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_sharing_settings.html">Sharing projects with project-level settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_permissions.html">Sharing projects with user-level permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="export_gps.html">Mapping, Sharing, and Exporting GPS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto_edit_single_submissions.html">Editing or Deleting a Single Submission</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto_edit_multiple_submissions.html">Editing Responses in Multiple Submissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="photo_download.html">Downloading Photos and Other Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="deleting_media.html">Deleting media files</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_organization_feature.html">Using the Team management feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="activity_logs.html">Monitoring project and account activity</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analyzing Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="creating_custom_reports.html">Viewing and Creating Custom Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="transcription-translation.html">Transcription and translation of audio responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="qualitative_analysis.html">Qualitative Analysis of Audio Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="converting_to_spss_and_stata.html">Converting Data into SPSS and/or Stata</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">Getting started with the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="synchronous_exports.html">Using the API for synchronous exports</a></li>
<li class="toctree-l1"><a class="reference internal" href="pulling_data_into_excelquery.html">Connecting KoboToolbox to Microsoft Excel</a></li>
<li class="toctree-l1"><a class="reference internal" href="pulling_data_into_powerbi.html">Connecting KoboToolbox to Power BI</a></li>
<li class="toctree-l1"><a class="reference internal" href="merging_dataset_excel_power_query.html">Merging Individual Data with Roster Data through Power Query in Excel</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest_services.html">REST Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="upload_to_gis.html">Exporting and Uploading Data to GIS Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="kobotoolbox_monday_integration.html">KoboToolbox Integration on monday.com</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrating_api.html">Migrating from v1 to v2 API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Security &amp; Protection</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="is_my_data_safe.html">KoboToolbox data security measures: Keeping your data safe</a></li>
<li class="toctree-l1"><a class="reference internal" href="gdpr.html">General Data Protection Regulation (GDPR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hipaa_compliance.html">HIPAA Compliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_storage.html">Data Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="encrypting_forms.html">Encrypting Forms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p_codes.html">Including P-Codes in the Output Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="unique_serial_numbers.html">Creating Unique Serial Numbers in Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_specified_other.html">User-Specified “Other” Responses for Multiple-Choice Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lower_file_size.html">Lowering the File Size of Collected Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculations_constraints_matrix.html">Adding Calculations and Constraints in a Matrix Question</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_skip_to_matrix.html">Adding Skip Logic to a Matrix Question</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_logo.html">Adding a Custom Logo</a></li>
<li class="toctree-l1"><a class="reference internal" href="stuck_in_pending.html">Exports Stuck in Pending State</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_upload.html">Manually Uploading Submissions</a></li>
</ul>

</div>




<section class="community-questions community-questions--sidebar">
  <div class="wrapper">
    <h1>Community Forum</h1>

    <p>For questions, ideas, and announcements on new releases, please head to our Community Forum.</p>

    <a class="button" href="https://community.kobotoolbox.org/">
      
      Visit our forum
      
    </a>
  </div>

   
        <br><br>
  

  <div class="wrapper">
    <h1>KoboToolbox Academy</h1>

    <p>KoboToolbox Academy offers high quality self-paced courses, created by KoboToolbox experts.</p>

    <a class="button" href="https://academy.kobotoolbox.org">
      Visit the KoboToolbox Academy
      
    </a>
  </div>
</section>

</aside>
      
  </div>
  <div class="clearer"></div>
</div>
  

  <div class="footer">
    <p>KoboToolbox is maintained by <a class="inline" href="https://www.kobotoolbox.org/about-us/">Kobo Inc.</a></p>
    <p>
        <a href="https://kobotoolbox.org/terms">Terms of Service</a>
        <a href="https://kobotoolbox.org/privacy">Privacy Policy</a>
    </p>
  </div>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXLRR9N1R5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXLRR9N1R5');
  </script>
  

  <script>
    window.docs = {
      currentPagename: "functions_xls",
      currentTitle: "Using functions in XLSForm",
      currentUrl: ("index.html").replace("index.html", "functions_xls.html"),
      rootUrl: "",
      sectionsData: {"account-billing": {"name": "account-billing", "title": "Account \u0026 Billing"}, "additional-resources": {"name": "additional-resources", "title": "Additional Resources"}, "analyzing-data": {"name": "analyzing-data", "title": "Analyzing Data"}, "collecting-data": {"name": "collecting-data", "title": "Collecting Data"}, "data-security-protection": {"name": "data-security-protection", "title": "Data Security \u0026 Protection"}, "getting-started": {"name": "getting-started", "title": "Getting Started"}, "integrations": {"name": "integrations", "title": "Integrations"}, "managing-projects": {"name": "managing-projects", "title": "Managing Projects \u0026 Data"}, "using-formbuilder": {"name": "using-formbuilder", "title": "Using the Formbuilder"}, "using-xlsform": {"name": "using-xlsform", "title": "Using XLSForm"}},
    };
  </script>
  </body>
</html>