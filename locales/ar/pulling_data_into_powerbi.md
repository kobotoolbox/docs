# ربط KoboToolbox بـ Power BI
**آخر تحديث:** <a href="https://github.com/kobotoolbox/docs/blob/ae9e699afd6c0ed484945430ba6722b974b99b49/source/pulling_data_into_powerbi.md" class="reference">22 آب 2022</a>

تتيح لك واجهة برمجة التطبيقات (API) الخاصة بـ KoboToolbox ربط مشروعك بأدوات تحليل البيانات الأخرى مثل Power BI وExcel وGoogle Sheets. يتم مشاركة البيانات التي تجمعها مع التطبيق الخارجي والذي يمكن استخدامه بعد ذلك للتحليل والتصورات ولوحات المعلومات.

أحد أشهر برامج تحليل البيانات والتصور التي يمكنك الاتصال بها هو [Microsoft Power BI](https://powerbi.microsoft.com).

يرشدك هذا المقال خلال خطوات ربط مشروعك بـ Power BI. إذا كنت ترغب في الاتصال بـ Excel، يُرجى الرجوع إلى المقال [هنا](pulling_data_into_excelquery.md).

## الخطوة 1: الحصول على رابط التصدير المتزامن

الخطوة الأولى في إدخال البيانات إلى Power BI هي الحصول على رابط التصدير المتزامن من خلال واجهة برمجة التطبيقات (API) الخاصة بـ KoboToolbox. تم توضيح عملية تفصيلية للقيام بذلك في المقال [هنا](synchronous_exports.md).

## الخطوة 2: إضافة مصدر البيانات

بمجرد حصولك على الرابط، يمكنك المتابعة بالخطوات أدناه في Power BI:

- انقر على السهم المنسدل في زر "Get Data"
- اختر "Web"
- الصق رابط التصدير المتزامن الذي نسخته وانقر على **OK**
- انقر على **Basic** لإضافة تفاصيل المصادقة الخاصة بك
- اكتب اسم المستخدم وكلمة المرور الخاصة بك في KoboToolbox وانقر على **CONNECT**

<p class="note">
  إذا جعلت بيانات مشروعك عامة، يمكنك الاتصال دون الحاجة إلى المصادقة عن طريق اختيار "Anonymous" في مربع الحوار "Access Web content". تعرّف على المزيد حول أذونات المشروع
  <a href="managing_permissions.html" class="reference">هنا</a>.
</p>

ستُعرض قائمة بالبيانات الموجودة في مشروعك في Navigator.

- اختر البيانات التي ترغب في استيرادها.
- انقر على **Load** لإدخال البيانات أو انقر على **Transform Data** لفتح محرر Power Query، والذي يمكنك استخدامه لتنظيف البيانات وتحويلها قبل تحميلها.

![Get data and Authentication](images/pulling_data_into_powerbi/get_data_auth.gif)

ستُعرض الجداول في لوحة **Fields** حيث يمكنك تطوير لوحات المعلومات والتقارير الخاصة بك.

<p class="note">
  في Power BI يمكنك ربط مشاريع متعددة. كرر العملية أعلاه لكل مشروع، باستخدام رابط التصدير المتزامن الخاص به. في حالة وجود جداول متعددة (على سبيل المثال إذا كان لديك مجموعات متكررة)، قد تحتاج أيضًا إلى إعداد علاقات الجداول. يتم ذلك في <strong>Model View</strong>.
  تعرّف على المزيد حول كيفية إنشاء علاقات الجداول
  <a
    href="https://docs.microsoft.com/en-us/power-bi/transform-model/desktop-create-and-manage-relationships"
    class="reference"
    >هنا</a
  >.
</p>

## تحديث البيانات في تقاريرك

عندما يتم تحديث بيانات مشروعك على خادم KoboToolbox، مثل عندما يكون لديك إرسالات جديدة أو تغييرات في حالات التحقق أو تعديلات أو حذف، ستحتاج إلى مزامنتها مع تقاريرك.

للقيام بذلك، انقر على **Refresh** في علامة التبويب "Home".

## استكشاف الأخطاء وإصلاحها

### فشل الاتصال بـ KoboToolbox

في بعض الأحيان، حتى بعد إدخال بيانات الاعتماد الصحيحة للاتصال بمشروعك، قد ترى خطأ. قد يحدث هذا إذا تم تكوين Power BI للاتصال بحساب واحد من قبل، وأنت الآن تحاول الاتصال باستخدام حساب مختلف من نفس خادم KoboToolbox.

لإعادة تعيين إعدادات المصادقة:

- انتقل إلى **File -> Options and Settings -> Data Source Settings**. حدد الأذونات الموجودة في مربع الحوار وانقر على **Clear Permissions**.
  أغلق وحاول إضافة الاتصال الجديد مرة أخرى.

![Clear Permissions](images/pulling_data_into_powerbi/data_source_settings.gif)

### فشل تحديث البيانات

إذا كنت تحصل على خطأ عند تحديث البيانات، فقد يكون هناك عدد من الأسباب:

- قد تكون تفاصيل المصادقة الخاصة بك قد تغيرت. ستحتاج إلى اتباع التعليمات أعلاه لتغيير **Data Source Settings** الخاصة بك.
- قد يكون تم حذف أو إعادة تسمية حقل واحد أو أكثر في نموذجك. ستحتاج إلى
  [تحرير الاستعلام](https://docs.microsoft.com/en-us/power-bi/transform-model/desktop-query-overview).
- قد يكون هناك عدم تطابق في نوع البيانات، خاصة إذا قمت بتغيير نوع البيانات لحقل واحد أو أكثر في Power BI. يمكنك محاولة إعادة تعيين نوع البيانات قبل تحديث الاتصال.