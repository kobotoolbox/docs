# دمج البيانات الفردية مع بيانات القوائم من خلال Power Query في Excel
**آخر تحديث:** <a href="https://github.com/kobotoolbox/docs/blob/73dbdbb56448bbfbdb62af8017b71582965291d2/source/merging_dataset_excel_power_query.md" class="reference">6 أبريل 2022</a>

كما هو موضح في مقالة الدعم،
[تجميع الأسئلة والمجموعات المتكررة](group_repeat.md)، يمكنك استخدام
المجموعات المتكررة لتلبية متطلبات معينة في الاستبيان. قد تحتاج أيضًا إلى
تحليل البيانات من المجموعات المتكررة التي تم جمعها. عند
[تنزيل البيانات من الخادم (بتنسيق XLS)](export_download.md)، يجب أن
ترى البيانات بالهيكل التالي:

![أوراق مجموعة البيانات](/images/merging_dataset_excel_power_query/dataset_sheets.png)

الورقة الأولى باسم **Repeat Group (Merge)** الظاهرة في الصورة
أعلاه تحتوي على _البيانات الفردية_ من الاستبيان بينما الورقة الثانية باسم
**CR** تحتوي على _بيانات القوائم_.

<p class="note">
  بالنسبة لمجموعات البيانات المُنزَّلة، يجب أن يكون لديك ورقة واحدة أكثر من عدد
  <em>المجموعات المتكررة</em>. على سبيل المثال، إذا كان لديك
  <em>مجموعة متكررة</em> واحدة مضمنة في نموذج الاستبيان، يجب أن يكون لديك ورقتان
  في مجموعة البيانات الخاصة بك.
</p>

ستوضح مقالة الدعم هذه أيضًا الفرق بين _البيانات الفردية_
و_بيانات القوائم_. ثم ستعرض الخطوات لكيفية دمجها في
مجموعة بيانات واحدة من خلال **Power Query** في **Excel**.

دمج _البيانات الفردية_ و_بيانات القوائم_ من خلال النظام غير
متاح حاليًا ولكنه ممكن من خلال **Power Query** في **Excel**. تم اختيار Excel على البرامج الأخرى لأنه جدول بيانات مستخدم على نطاق واسع ومتاح
لجميع أجهزة الكمبيوتر تقريبًا. كما أنه سهل الاستخدام نسبيًا.

## الفروق بين البيانات الفردية وبيانات القوائم:

_البيانات الفردية_ هي معلومات يتم التقاطها بشكل عام مرة واحدة فقط في
مقابلة. _بيانات القوائم_، من ناحية أخرى، يتم التقاطها أكثر من مرة _(على سبيل المثال،
تفاصيل جميع أفراد الأسرة الذين يعيشون داخل منزل)_ من نفس
الفرد في مقابلة. قد يساوي عدد الحالات في _البيانات الفردية_
_بيانات القوائم_ ولكن لا يمكن أن يتجاوزها أبدًا، بينما عدد الحالات في _بيانات
القوائم_ يتجاوز عمومًا _البيانات الفردية_ ولكن قد يكون أحيانًا مساويًا (ولكن
لا يقل أبدًا).

نموذج استبيان مملوء، كما هو موضح أدناه، يجب أن يُظهر في صورة
الفروق بين _البيانات الفردية_ و_بيانات القوائم_. _يرجى ملاحظة أن جميع البيانات
المستخدمة في مقالة الدعم هذه افتراضية_.

![النموذج](/images/merging_dataset_excel_power_query/form.png)

<p class="note">
  أي بيانات يتم جمعها خارج المجموعة المتكررة هي
  <em>بيانات فردية</em> وأي بيانات يتم جمعها داخل مجموعة متكررة
  هي <em>بيانات قوائم</em>.
</p>

البيانات المُنزَّلة بتنسيق XLS يجب أن تُظهر أيضًا الفرق بين
_البيانات الفردية_ و_بيانات القوائم_.

كل سجل _(كما هو موضح في الصورة أدناه)_، تحت `Name of the household head`،
`Sex of the household head`، `Total family members in the household`، و
`Total school going children (aged 6-16 years) in the household` من
الورقة الأولى **Repeat Group (Merge)** هو _بيانات فردية_.

![البيانات الفردية](/images/merging_dataset_excel_power_query/individual_data.png)

مجموعة البيانات النموذجية هذه تحتوي على إجمالي 7 مقابلات كـ _بيانات فردية_.

وبالمثل، كل سجل _(كما هو موضح في الصورة أدناه)_، تحت `Name of child`،
`Age of child`، و`Sex of child` من الورقة الثانية، **CR**، هو _بيانات
قوائم_.

![بيانات القوائم](/images/merging_dataset_excel_power_query/roster_data.png)

لذلك، مجموعة البيانات النموذجية هذه تحتوي على إجمالي 12 سجلاً كـ _بيانات قوائم_.

<p class="note">
  <strong>ملاحظة:</strong> أثناء تنزيل مجموعة بيانات من الخادم، يجب أن
  تتمكن أيضًا من رؤية متغيرات أخرى (متغيرات البيانات الوصفية) إذا لم يتم
  تصفيتها. تم إزالتها من مجموعة البيانات النموذجية هذه للتبسيط.
</p>

## دمج البيانات الفردية مع بيانات القوائم:

إذا نظرت عن كثب إلى الصور المشتركة أعلاه، يمكنك رؤية عمود `_index` بقيمة "1" في الورقة الأولى **Repeat Group (Merge)**. وبالمثل، يوجد أيضًا
عمود `_parent_index` بقيمة "1" في الورقة الثانية **CR**. `_index` و
`_parent_index` هي متغيرات إضافية أنشأها النظام لإدارة المجموعات المتكررة. إنها متغيرات مطابقة مطلوبة لدمج _البيانات الفردية_ و
_بيانات القوائم_ معًا في واحدة.

فيما يلي نهجان لدمج _البيانات الفردية_ و_بيانات القوائم_ في
مجموعة بيانات واحدة من خلال **Power Query** في **Excel**. يمكنك استخدام أي من
النهجين التاليين:

### النهج الأول: دمج البيانات الفردية مع بيانات القوائم (عندما تكون مجموعة البيانات مفتوحة بالفعل)

بالنسبة للنهج الأول، يجب أن تكون قد فتحت مجموعة بيانات XLS الخاصة بك. للحصول على التفاصيل،
يرجى مشاهدة الفيديو أدناه:

<video controls>
  <source
    src="./_static/files/merging_dataset_excel_power_query/xls_dataset_open.mp4"
    type="video/mp4"
  />
</video>

-   افتح مجموعة البيانات التي تحتوي على كل من _البيانات الفردية_ و_بيانات القوائم_.

-   حدد جميع البيانات من الورقة الأولى _(البيانات الفردية)_.

-   ضمن علامة التبويب **Data**، حدد **From Table/Range**.

-   سيظهر مربع حوار **(Create Table)**. حدد **OK**.

-   حدد أيقونة **Close & Load** الموجودة في الزاوية العلوية اليسرى من
    الشاشة. يجب أن ترى الآن خيارين منسدلين: **Close & Load** و
    **Close & Load To …**.

-   حدد **Close & Load To …**.

-   سيظهر مربع حوار **(Import Data)**. حدد **Only Create
    Connection** ثم اضغط على **OK**.

-   لقد أنشأت الآن جدول استعلام لـ _(البيانات الفردية)_.

-   يمكنك الآن الانتقال إلى الورقة الثانية، _(بيانات القوائم)_، واتباع نفس
    الخطوات التي قمت بها أعلاه.

-   بهذا تكون قد أنشأت جدول استعلام لـ _(بيانات القوائم)_.

-   ضمن علامة التبويب **Data**، حدد **Get Data**. من هناك، حدد **Combine
    Queries** ثم **Merge**.

-   يظهر مربع حوار **Merge**.

-   قم بتحميل كلا جدولي الاستعلام. بمجرد تحميل كلا الجدولين، حدد
    المتغير المطابق `_index` من الجدول الأول. وبالمثل، حدد
    المتغير المطابق `_parent_index` من الجدول الثاني. بمجرد
    تحديد كلا المتغيرين المطابقين يجب أن تتمكن من رؤية **The selection
    matches … of … rows from the first table**. يجب أن يكون جدول الاستعلام الآن
    مدمجًا.

-   لتوسيع الجدول المدمج، حدد جميع المتغيرات التي ترغب في الحصول عليها في
    مجموعة البيانات المدمجة. يمكنك أيضًا إلغاء تحديد **Use original column name as
    prefix** للحصول على اسم المتغير الأصلي في مجموعة البيانات المدمجة. عندما
    يتم كل شيء، حدد **OK**.

-   يجب أن يكون لديك الآن مجموعة البيانات المدمجة النهائية.

-   مرة أخرى، حدد أيقونة **Close & Load** الموجودة في الزاوية العلوية اليسرى
    من الشاشة. يجب أن ترى خيارين منسدلين: **Close & Load**
    و**Close & Load To …**.

-   حدد **Close & Load**. بهذه النقرة النهائية تكون قد دمجت
    _البيانات الفردية_ و_بيانات القوائم_ في مجموعة بيانات واحدة.

### النهج الثاني: دمج البيانات الفردية مع بيانات القوائم (عندما لا تكون مجموعة البيانات مفتوحة بعد)

استخدم النهج الثاني عندما لم تفتح بعد مجموعة بيانات XLS الخاصة بك وفقط
فتحت مصنف Excel جديد. للحصول على التفاصيل، يرجى مشاهدة الفيديو أدناه:

<video controls>
  <source
    src="./_static/files/merging_dataset_excel_power_query/new_excel_workbook.mp4"
    type="video/mp4"
  />
</video>

-   افتح مصنف Excel جديد.

-   ضمن علامة التبويب **Data**، حدد **Get Data**. من هناك حدد **From File**
    ثم **From Workbook**.

-   ابحث عن الملف من جهاز الكمبيوتر الخاص بك. بمجرد رؤيته، حدد الملف ثم
    اضغط على **Import**.

-   يظهر مربع حوار **Navigator**. هنا، حدد **Select multiple items**
    وأسماء الأوراق **CR** و**Repeat Group (Merge)** المرئية.
    بمجرد تحديدها يتم تنشيط زر **Load** في أسفل مربع الحوار.

-   حدد زر **Load**. يجب أن ترى خيارين منسدلين: **Load**
    و**Load To …**. حدد **Load**.

-   بهذا، تكون قد أنشأت جداول استعلام لـ _(البيانات الفردية)_ و
    _(بيانات القوائم)_.

-   ضمن علامة التبويب **Data**، حدد **Get Data**. من هناك، حدد **Combine
    Queries** ثم حدد **Merge**.

-   يظهر مربع حوار **Merge**.

-   قم بتحميل كلا جدولي الاستعلام. بمجرد تحميل كلا الجدولين، حدد
    المتغير المطابق `_index` من الجدول الأول. وبالمثل، حدد
    المتغير المطابق `_parent_index` من الجدول الثاني. بمجرد
    تحديد كلا المتغيرين المطابقين يجب أن تتمكن من رؤية **The selection
    matches … of … rows from the first table**. يجب أن يكون جدول الاستعلام الآن
    مدمجًا.

-   لتوسيع الجدول المدمج، حدد جميع المتغيرات التي ترغب في الحصول عليها في
    مجموعة البيانات المدمجة. يمكنك أيضًا إلغاء تحديد **Use original column name as
    prefix** للحصول على اسم المتغير الأصلي في مجموعة البيانات المدمجة. عندما
    يتم كل شيء، حدد **OK**.

-   يجب أن يكون لديك الآن مجموعة البيانات المدمجة النهائية.

-   مرة أخرى، حدد أيقونة **Close & Load** الموجودة في الزاوية العلوية اليسرى
    من الشاشة. يجب أن ترى خيارين منسدلين: **Close & Load**
    و**Close & Load To …**.

-   حدد **Close & Load**. بهذه النقرة النهائية تكون قد دمجت
    _البيانات الفردية_ و_بيانات القوائم_ في مجموعة بيانات واحدة.

<p class="note">
  الفروق في النهجين هي في تحميل جدول الاستعلام. بمجرد
  تحميل جداول الاستعلام، ستحتاج إلى اتباع نفس الخطوات لدمج
  <em>البيانات الفردية</em> و<em>بيانات القوائم</em>.
</p>

## استكشاف الأخطاء وإصلاحها:

-   تصدير _المجموعات المتكررة_ غير مدعوم بتنسيق CSV. ستحتاج إلى
    تنزيل البيانات بتنسيق XLS.

-   Microsoft Power Query for Excel هو وظيفة إضافية لـ Excel. يمكنك تنزيله
    من خلال
    [موقع تنزيل Microsoft](https://www.microsoft.com/en-us/download/details.aspx?id=39379).
    يجب أن يعمل بشكل أفضل على _Excel for Microsoft 365_ أو _Excel 2021_، _Excel
    2019_، _Excel 2016_، _Excel 2013_، و_Excel 2010_. لمزيد من التفاصيل،
    يرجى الاطلاع على
    [موقع دعم Microsoft](https://support.microsoft.com/en-us/office/about-power-query-in-excel-7104fbee-9e62-4cb9-a02e-5bfb1a6c536a).

<p class="note">
  للممارسة، يمكنك الوصول إلى XLSForm
  <a
    download
    class="reference"
    href="./_static/files/merging_dataset_excel_power_query/repeat_group_(merge).xlsx"
    >هنا</a
  >
  ومجموعة البيانات النموذجية
  <a
    download
    class="reference"
    href="./_static/files/merging_dataset_excel_power_query/repeat_group_(merge)_dataset.xlsx"
    >هنا</a
  >
  التي تم استخدامها في هذه المقالة.
</p>